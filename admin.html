<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin – SzakiPiac</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="margin:0; font-family:Arial; background-color:#f9fff3;">

<header style="background-color:#2e7d32; color:white; padding:15px; text-align:center;">
  <h1>SzakiPiac.hu</h1>
</header>
<nav style="background-color:#388e3c; display:flex; justify-content:center;">
  <a href="index.html" style="color:white; padding:14px 20px; text-decoration:none;">Főoldal</a>
  <a href="rolunk.html" style="color:white; padding:14px 20px; text-decoration:none;">Rólunk</a>
  <a href="kapcsolat.html" style="color:white; padding:14px 20px; text-decoration:none;">Kapcsolat</a>
  <a href="feltoltes.html" style="color:white; padding:14px 20px; text-decoration:none;">Hirdetés feltöltés</a>
  <a href="admin.html" style="color:white; padding:14px 20px; text-decoration:none;">Admin</a>
</nav>

<div style="max-width:600px;margin:auto;padding:20px;">
  <h2>Admin bejelentkezés</h2>
  <div id="auth">
    <input type="email" id="email" placeholder="E-mail" style="width:100%;padding:10px;margin-bottom:10px;"><br>
    <input type="password" id="password" placeholder="Jelszó" style="width:100%;padding:10px;margin-bottom:10px;"><br>
    <button onclick="login()" style="padding:10px 20px;background:#2e7d32;color:white;border:none;border-radius:5px;">Bejelentkezés</button>
    <p style="font-size:12px;">Használható e-mail: <b>atika.76@windowslive.com</b></p>
  </div>
  <div id="ads" style="display:none;">
    <h3>Beküldött hirdetések</h3>
    <div id="ads-list"></div>
  </div>
</div>

<script>
const supabase = supabase.createClient(
  "https://tzmcofiuqeanftviquwp.supabase.co",
  "public-anon-key"
);

async function login() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  const { data, error } = await supabase.auth.signInWithPassword({
    email: email,
    password: password
  });

  if (error || email !== "atika.76@windowslive.com") {
    alert("Hibás belépési adatok vagy jogosultság!");
    return;
  }

  document.getElementById("auth").style.display = "none";
  document.getElementById("ads").style.display = "block";
  loadAds();
}

async function loadAds() {
  const { data, error } = await supabase.from("ads").select("*").order("created_at", { ascending: false });
  if (error) {
    alert("Nem sikerült betölteni a hirdetéseket.");
    return;
  }

  const list = document.getElementById("ads-list");
  list.innerHTML = "";
  data.forEach(ad => {
    const div = document.createElement("div");
    div.style = "margin-bottom:15px;padding:10px;border:1px solid #ccc;border-radius:5px;background:white;";
    div.innerHTML = `<b>${ad.cim}</b><br>${ad.leiras}<br><i>${ad.ar} Ft – ${ad.email}</i>`;
    list.appendChild(div);
  });
}
</script>
</body>
</html>