<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Hirdetés feltöltése – SzakiPiac.hu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="margin:0; font-family:Arial; background-color:#f1f8e9;">

<header style="background-color:#2e7d32; color:white; padding:15px; text-align:center;">
  <h1>SzakiPiac.hu</h1>
</header>
<nav style="background-color:#388e3c; display:flex; justify-content:center;">
  <a href="index.html" style="color:white; padding:14px 20px; text-decoration:none;">Főoldal</a>
  <a href="rolunk.html" style="color:white; padding:14px 20px; text-decoration:none;">Rólunk</a>
  <a href="kapcsolat.html" style="color:white; padding:14px 20px; text-decoration:none;">Kapcsolat</a>
  <a href="feltoltes.html" style="color:white; padding:14px 20px; text-decoration:none;">Hirdetés feltöltés</a>
  <a href="admin.html" style="color:white; padding:14px 20px; text-decoration:none;">Admin</a>
</nav>

<div style="max-width:600px;margin:auto;padding:20px;background:white;margin-top:20px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,0.1);">
  <h2>Hirdetés feltöltése</h2>
  <form onsubmit="handleSubmit(event)">
    <label>Cím:<br><input id="cim" type="text" required style="width:100%;padding:8px;"></label><br><br>
    <label>Leírás:<br><textarea id="leiras" rows="5" required style="width:100%;padding:8px;"></textarea></label><br><br>
    <label>Ár (Ft):<br><input id="ar" type="number" required style="width:100%;padding:8px;"></label><br><br>
    <label>E-mail:<br><input id="email" type="email" required style="width:100%;padding:8px;"></label><br><br>
    <button type="submit" style="padding:10px 20px;background:#2e7d32;color:white;border:none;border-radius:5px;">Fizetés és mentés</button>
  </form>
</div>

<script>
const supabase = supabase.createClient(
  "https://tzmcofiuqeanftviquwp.supabase.co",
  "public-anon-key"
);

async function handleSubmit(event) {
  event.preventDefault();

  // PayPal fizetés elindítása
  const fizetes = confirm("A hirdetés díja 1290 Ft. Továbbmész PayPal fizetésre?");
  if (!fizetes) return;

  window.open("https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=bartha.attila76@gmail.com&item_name=SzakiPiac+hirdetés&amount=1290&currency_code=HUF", "_blank");

  const cim = document.getElementById("cim").value;
  const leiras = document.getElementById("leiras").value;
  const ar = document.getElementById("ar").value;
  const email = document.getElementById("email").value;

  const { error } = await supabase.from("ads").insert([{ cim, leiras, ar, email }]);
  if (error) {
    alert("Hiba történt a mentés során.");
    console.error(error);
  } else {
    alert("A hirdetés mentése sikeres! Ellenőrizheted az admin oldalon.");
    event.target.reset();
  }
}
</script>
</body>
</html>