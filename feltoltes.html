<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Hirdetés feltöltés – SzakiPiac.hu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="logo.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="green-header">
    <img src="logo.png" class="logo" alt="SzakiPiac logó">
    <nav>
      <a href="index.html">Főoldal</a>
      <a href="rolunk.html">Rólunk</a>
      <a href="kapcsolat.html">Kapcsolat</a>
      <a href="feltoltes.html" style="font-weight:bold;">Hirdetés feltöltés</a>
      <a href="auth.html">Bejelentkezés</a>
    </nav>
    <div class="reklam-header">
      <img src="reklam.png" alt="Reklám" style="height:42px;">
    </div>
  </header>
  <div class="container">
    <div class="content-box">
      <h1>Hirdetés feltöltés</h1>
      <form id="feltoltesForm">
        <label>Cím:<br>
          <input type="text" name="cim" required maxlength="60">
        </label><br><br>
        <label>Leírás:<br>
          <textarea name="leiras" rows="3" required maxlength="500"></textarea>
        </label><br><br>
        <label>Kategória:<br>
          <select name="kategoria" required>
            <option value="">Válassz kategóriát</option>
            <option value="Építőipar">Építőipar</option>
            <option value="Kertépítés">Kertépítés</option>
            <option value="Lakberendezés">Lakberendezés</option>
            <option value="Számítástechnika">Számítástechnika</option>
          </select>
        </label><br><br>
        <label>Ár (Ft):<br>
          <input type="number" name="ar" min="0">
        </label><br><br>
        <label>Csomag:<br>
          <select id="csomagValaszto" name="csomag" required>
            <option value="Alap">Alap (ingyenes, 2 kép, 7 nap)</option>
            <option value="Prémium">Prémium (1990 Ft, 3 kép, 14 nap)</option>
            <option value="Extra">Extra (2990 Ft, 5 kép, 30 nap)</option>
          </select>
        </label><br><br>
        <label>Képek feltöltése (csomagtól függő mennyiség):<br>
          <input type="file" name="kepek" id="kepek" accept="image/*" multiple>
        </label><br><br>
        <div id="paypal-gomb" style="display:none; margin-bottom:16px;">
          <div id="paypal-button-container"></div>
        </div>
        <button type="submit" id="feltoltBtn">Feltöltés</button>
      </form>
      <div id="uzenet" style="margin-top:18px;"></div>
    </div>
  </div>
  <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=HUF"></script>
  <script>
    const paypalBtnDiv = document.getElementById('paypal-gomb');
    const csomagValaszto = document.getElementById('csomagValaszto');
    let paypalSelected = false;
    let fizetesOsszeg = 0;

    csomagValaszto.addEventListener('change', function () {
      paypalSelected = false;
      if (csomagValaszto.value === "Prémium") {
        paypalBtnDiv.style.display = 'block';
        fizetesOsszeg = 1990;
        renderPayPal(fizetesOsszeg);
      } else if (csomagValaszto.value === "Extra") {
        paypalBtnDiv.style.display = 'block';
        fizetesOsszeg = 2990;
        renderPayPal(fizetesOsszeg);
      } else {
        paypalBtnDiv.style.display = 'none';
      }
    });

    function renderPayPal(amount) {
      paypal.Buttons({
        createOrder: function (data, actions) {
          return actions.order.create({
            purchase_units: [{
              amount: { value: (amount / 360).toFixed(2), currency_code: "HUF" }, // PayPal sandbox nem tud HUF-ot, demo csak!
              description: "SzakiPiac hirdetés"
            }]
          });
        },
        onApprove: function (data, actions) {
          paypalSelected = true;
          document.getElementById('uzenet').innerHTML = "<span style='color:green;'>Fizetés sikeres! Most már feltöltheted a hirdetést.</span>";
        }
      }).render('#paypal-button-container');
    }

    document.getElementById('feltoltesForm').addEventListener('submit', function(e){
      e.preventDefault();
      if ((csomagValaszto.value === "Prémium" || csomagValaszto.value === "Extra") && !paypalSelected) {
        document.getElementById('uzenet').innerHTML = "<span style='color:red;'>Előbb fizess PayPallal!</span>";
        return;
      }
      // Itt a tényleges feltöltés logikája (Supabase/API), most csak demo üzenet:
      document.getElementById('uzenet').innerHTML = "<b style='color:green;'>Hirdetés sikeresen feltöltve!</b>";
      document.getElementById('feltoltesForm').reset();
      paypalSelected = false;
    });
  </script>
</body>
</html>
